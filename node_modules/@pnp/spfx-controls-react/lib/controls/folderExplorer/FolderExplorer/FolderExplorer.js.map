{"version":3,"sources":["controls/folderExplorer/FolderExplorer/FolderExplorer.tsx"],"names":[],"mappings":"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","file":"controls/folderExplorer/FolderExplorer/FolderExplorer.js","sourcesContent":["import * as React from 'react';\nimport { TextField } from \"office-ui-fabric-react/lib/TextField\";\nimport styles from './FolderExplorer.module.scss';\nimport * as strings from 'ControlStrings';\nimport { Icon } from \"office-ui-fabric-react/lib/Icon\";\nimport { IFolderExplorerProps, IFolderExplorerState } from '.';\nimport { FolderExplorerService } from '../../../services/FolderExplorerService';\nimport { IFolder, IFolderExplorerService } from '../../../services/IFolderExplorerService';\nimport { NewFolder } from \"../NewFolder\";\nimport { Breadcrumb, IBreadcrumbItem } from \"office-ui-fabric-react/lib/Breadcrumb\";\nimport * as telemetry from '../../../common/telemetry';\n\n\nexport class FolderExplorer extends React.Component<IFolderExplorerProps, IFolderExplorerState> {\n\n  private _spService: IFolderExplorerService;\n  private _allFolders: IFolder[] = [];\n\n  constructor(props: IFolderExplorerProps) {\n    super(props);\n\n    telemetry.track('FolderExplorer');\n\n    this._spService = new FolderExplorerService(this.props.context.serviceScope);\n\n    this.state = {\n      foldersLoading: false,\n      folders: [],\n      selectedFolder: null,\n    };\n  }\n\n  public async componentDidMount() {\n    await this._getSubFolders(this.props.defaultFolder ? this.props.defaultFolder : this.props.rootFolder);\n  }\n\n  public render(): React.ReactElement<IFolderExplorerProps> {\n    return (\n      <div>\n        {!this.props.hiddenBreadcrumb &&\n          this._getBreadcrumbDOM()\n        }\n        <div style={{ opacity: this.state.foldersLoading ? 0.8 : 1, }}>\n          {!this.props.hiddenFilterBox && this._allFolders.length > 0 &&\n            <div>\n              <TextField className={styles.filterBox} placeholder={strings.FolderFilterBoxPlaceholder} onChanged={this._onChangeFilterText} />\n            </div>\n          }\n          {this.state.folders.length === 0 &&\n            <div className={styles.status}>\n              <span role=\"status\">{this.state.foldersLoading ? strings.FolderExplorerLoading : strings.FolderExplorerNoItems}</span>\n            </div>\n          }\n          {this.state.folders.length > 0 &&\n            <div>\n              {this.state.folders.map((folder) => {\n                return (\n                  <div className={styles.libraryItem} onClick={() => { this._getSubFolders(folder); }}>\n                    <Icon iconName=\"FabricFolder\" className={styles.folderIcon} />\n                    {folder.Name}\n                  </div>\n                );\n              })\n              }\n            </div>\n          }\n          {this.props.canCreateFolders &&\n            <NewFolder context={this.props.context}\n              selectedFolder={this.state.selectedFolder}\n              addSubFolder={this._addSubFolder}></NewFolder>\n          }\n        </div>\n      </div>\n    );\n\n  }\n\n  /**\n * Get HTML elements for rendering breadcrumb\n */\n  private _getBreadcrumbDOM = (): JSX.Element => {\n    let breadCrumbDOM = null;\n\n    let breadCrumbItems = this._getCurrentBreadcrumbItems();\n    let overflowIndex = breadCrumbItems.length > 1 ? 1 : 0;\n    breadCrumbDOM = <Breadcrumb items={breadCrumbItems} className={styles.breadcrumbPath} maxDisplayedItems={3} overflowIndex={overflowIndex} />;\n\n    return breadCrumbDOM;\n  }\n\n  /**\n * Get breadcrumb items\n * @returns an array of IBreadcrumbItem objects\n */\n  private _getCurrentBreadcrumbItems = (): IBreadcrumbItem[] => {\n    let items: IBreadcrumbItem[] = [];\n\n    let rootItem: IBreadcrumbItem = { text: this.props.rootFolder.Name, key: 'Root-Item', onClick: this._getSubFolders.bind(this, this.props.rootFolder) };\n    items.push(rootItem);\n\n    if (this.state.selectedFolder && this.state.selectedFolder.ServerRelativeUrl !== this.props.rootFolder.ServerRelativeUrl) {\n      const folderPathSplit = this.state.selectedFolder.ServerRelativeUrl.replace(this.props.rootFolder.ServerRelativeUrl, '').split('/');\n      let folderPath = this.props.rootFolder.ServerRelativeUrl;\n      folderPathSplit.forEach((folderName, index) => {\n        if (folderName !== '') {\n          folderPath += '/' + folderName;\n          let folderItem: IBreadcrumbItem = { text: folderName, key: `Folder-${index.toString()}`, onClick: this._getSubFolders.bind(this, { Name: folderName, ServerRelativeUrl: folderPath }) };\n          items.push(folderItem);\n        }\n      });\n    }\n\n    items[items.length - 1].isCurrentItem = true;\n    return items;\n  }\n\n  /**\n * Filter list of folders based on user input\n * @param filterText - The text to use when filtering the collection\n */\n  private _onChangeFilterText = (filterText: string): void => {\n    this.setState({\n      folders: filterText ? this._allFolders.filter(f => f.Name.toLowerCase().indexOf(filterText.toLowerCase()) > -1) : this._allFolders\n    });\n  }\n\n  /**\n* Load sub folders and files within a given folder\n* @param folder - Name of the folder\n*/\n  private _getSubFolders = async (folder: IFolder): Promise<void> => {\n\n    this.setState({ foldersLoading: true });\n    try {\n      this._allFolders = await this._spService.GetFolders(this.props.context.pageContext.web.absoluteUrl, folder.ServerRelativeUrl);\n      this.setState({ folders: this._allFolders, selectedFolder: folder, foldersLoading: false });\n\n      // callback to parent component\n      this.props.onSelect(folder);\n\n    } catch (error) {\n      this.setState({ selectedFolder: null, foldersLoading: false });\n      console.error(error);\n    }\n  }\n\n  /**\n  * Add new subfolder to current folder\n  */\n  private _addSubFolder = async (newFolder: IFolder): Promise<void> => {\n    if (newFolder) {\n\n      // add folder if a folder with the same name does not exist yet\n      if (!this._allFolders.some(f => f.Name === newFolder.Name)) {\n        // update both list of folders\n        this._allFolders.push(newFolder);\n        this.setState({\n          folders: this._allFolders\n        });\n      }\n    }\n  }\n}\n"],"sourceRoot":"../../../../src"}